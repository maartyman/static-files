@prefix schema: <http://schema.org/>.
@prefix foaf:   <http://xmlns.com/foaf/0.1/>.

@prefix rr:     <http://www.w3.org/ns/r2rml#>.
@prefix rml:    <http://semweb.mmlab.be/ns/rml#>.
@prefix ql:     <http://semweb.mmlab.be/ns/ql#>.
@prefix ex:     <http://example.com/ns#>.
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#>.
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#>.
@prefix sd:     <http://www.w3.org/ns/sparql-service-description#>.
@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.

<#InputSPARQL>
    a sd:Service ;
    sd:endpoint <http://localhost:3330/dataset> ;
    sd:supportedLanguage sd:SPARQL11Query ;
    sd:resultFormat <http://www.w3.org/ns/formats/SPARQL_Results_JSON> .

<MapPerson>
    a rml:TriplesMap;
    rml:logicalSource [
          rml:source <#InputSPARQL>;
          rml:referenceFormulation ql:JSONPath;
          rml:iterator "$.results.bindings[*]";
          rml:query """
            PREFIX ex: <http://example.com/ns#>
            SELECT ?s WHERE { ?s a foaf:Person }
            """
      ];
    rr:subjectMap [ rml:reference "s.value" ];
    rr:predicateObjectMap [
                              rr:predicateMap [ rr:constant rdf:type; rr:termType rr:IRI ] ;
                              rr:objectMap [ rml:reference schema:Person ; rr:termType rr:IRI ]
                          ].
<MapKnows>
    a rml:TriplesMap;
    rml:logicalSource [
          rml:source <#InputSPARQL>;
          rml:referenceFormulation ql:JSONPath;
          rml:iterator "$.results.bindings[*]";
          rml:query """
            PREFIX ex: <http://example.com/ns#>
            SELECT ?s ?o WHERE { ?s foaf:knows ?o }
            """
      ];
    rr:subjectMap [ rml:reference "s.value" ];
    rr:predicateObjectMap [
                              rr:predicateMap [ rr:constant schema:knows; rr:termType rr:IRI ] ;
                              rr:objectMap [ rml:reference "o.value" ; rr:termType rr:IRI ]
                          ].
